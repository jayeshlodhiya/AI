<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>AI Call Assistants</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root{
            --bg:#f7f8fb; --panel:#fff; --text:#0f172a; --muted:#6b7280;
            --border:#e5e7eb; --radius:18px; --shadow:0 8px 24px rgba(16,24,40,.06);
            --chip-bg:#eaf6ee; --chip-text:#166534; /* OUTBOUND */
            --brand:#6c4df6; --brand-strong:#5b3df0; /* Test button */
            --line:#e7edf7;
        }
        *{box-sizing:border-box}
        body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial;padding:18px}

        .card{background:var(--panel);border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);margin-bottom:18px}
        .card .header{padding:14px 16px;border-bottom:1px solid var(--border);font-weight:700;display:flex;align-items:center;justify-content:space-between}
        .card .body{padding:16px}

        .btn{border:0;border-radius:14px;padding:12px 18px;font-weight:700;display:inline-flex;gap:10px;align-items:center;cursor:pointer;box-shadow:var(--shadow);transition:background .15s ease, transform .06s ease}
        .btn:active{transform:translateY(1px)}
        .btn.gray{background:#f3f4f6;color:#1f2937;border:1px solid var(--border)}
        .btn.primary{background:var(--brand);color:#fff}
        .btn.primary:hover{background:var(--brand-strong)}
        .btn[disabled]{opacity:.6;cursor:not-allowed}

        .input,.select{width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:12px;background:#fff}

        .list{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:18px}

        /* ---------- Dynamic Assistant Card (matches screenshot) ---------- */
        .agent-card{border:1px solid #dbe2f0;border-radius:20px;padding:18px;background:#fff;display:grid;gap:14px}
        .agent-top{display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center;
            background: radial-gradient(120px 40px at 40% 22%, rgba(108,77,246,.06), transparent 60%);
            border-radius:16px;padding:8px}
        .agent-avatar{width:56px;height:56px;border-radius:50%;object-fit:cover;background:#e5e7eb}
        .agent-name{font-size:20px;font-weight:700;letter-spacing:.2px}
        .agent-menu{width:36px;height:36px;border-radius:12px;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;cursor:pointer}

        .badge{display:inline-flex;align-items:center;padding:8px 14px;border-radius:12px;font-weight:800;font-size:13px;background:var(--chip-bg);color:var(--chip-text);width:fit-content;margin-top:6px}

        .agent-title{font-size:24px;line-height:1.25;font-weight:800;color:#162449;margin-top:6px}
        .agent-company{display:flex;align-items:center;gap:10px;color:#8e2d2d;font-weight:600;margin-top:6px}
        .briefcase{width:22px;height:22px;border-radius:6px;background:#fde8e8;display:inline-flex;align-items:center;justify-content:center;color:#b91c1c;font-size:12px}

        .divider{height:1px;background:var(--line);margin:10px 0;border-radius:999px}
        .agent-actions{display:flex;gap:14px}
        .btn.role{background:#fff;border:1px solid #dbe2f0;color:#3a2e2e}

        /* utility */
        .status{font-size:13px;color:var(--muted)}
        .spinner{width:12px;height:12px;border:2px solid #93c5fd;border-top-color:transparent;border-radius:50%;display:inline-block;animation:spin .8s linear infinite;margin-right:6px}
        @keyframes spin{to{transform:rotate(360deg)}}
    </style>
</head>
<body>

<!-- Top controls -->
<section class="card">
    <div class="header">
        <span>ü§ñ AI Call Assistants</span>
        <div>
            <button class="btn gray" id="refreshBtn">Refresh</button>
            <button class="btn primary" id="openCreateBtn">‚ûï Create Assistant</button>
        </div>
    </div>
    <div class="body">
        <div id="statusText" class="status"><span class="spinner"></span> Loading assistants‚Ä¶</div>
    </div>
</section>

<!-- Quick Test (unchanged wiring; your JS populates the select and uses playgroundCall) -->
<section class="card">
    <div class="header">Quick Test (Sample Assistant)</div>
    <div class="body">
        <div class="list">
            <div class="agent-card">
                <div class="agent-top" style="grid-template-columns:auto 1fr;">
                    <img class="agent-avatar" src="https://placehold.co/112x112" alt="Assistant Avatar">
                    <div>
                        <div class="agent-name">Demo Sales Assistant</div>
                        <div class="badge">OUTBOUND</div>
                    </div>
                </div>

                <div class="list" style="grid-template-columns:1fr;gap:10px;margin-top:2px">
                    <div>
                        <label for="qt_assistant" class="status" style="display:block;margin-bottom:6px">Select Assistant</label>
                        <select id="qt_assistant" class="select">
                            <option value="">Loading assistants‚Ä¶</option>
                        </select>
                    </div>
                    <div style="display:flex;gap:10px">
                        <input id="nm_qt" class="input" placeholder="Customer name (optional)" aria-label="Customer name">
                        <input id="ph_qt" class="input" placeholder="+917350348860" aria-label="Customer phone">
                    </div>
                </div>

                <div class="divider"></div>

                <div class="agent-actions">
                    <button class="btn role" disabled>üåê Role Play</button>
                    <button class="btn primary"
                            id="qt_call_btn"
                            data-action="quick-test-call"
                            data-assistant-select="#qt_assistant"
                            data-name="#nm_qt"
                            data-phone="#ph_qt"
                            disabled>üìû Test</button>
                </div>
            </div>
        </div>
        <div class="status" style="margin-top:8px">Tip: Select an assistant, enter number, then press Test.</div>
    </div>
</section>

<!-- Existing Assistants (DYNAMIC) -->
<section class="card">
    <div class="header">Existing Assistants <span id="countPill" class="badge" style="display:none"></span></div>
    <div class="body">
        <div id="assistantsList" class="list" aria-live="polite"></div>
        <div id="emptyState" class="status" style="display:none">No assistants found.</div>
    </div>
</section>

<!-- Create Assistant -->
<section class="card" id="createCard" style="display:none;">
    <div class="header">
        <span>Create New Assistant</span>
        <div>
            <button class="btn gray" id="cancelCreateBtn">Cancel</button>
            <button class="btn primary" id="createBtn">Create</button>
        </div>
    </div>
    <div class="body" style="display:grid;gap:12px">
        <input id="ca_name" class="input" placeholder="Assistant Name" />
        <input id="ca_company" class="input" placeholder="Company / Brand" />
        <input id="ca_voice" class="input" placeholder="Voice (optional)" />
        <textarea id="ca_prompt" class="input" rows="4" placeholder="System Prompt / Persona"></textarea>
        <div id="createStatus" class="status"></div>
    </div>
</section>

<!-- Template the JS will clone for each assistant result -->
<template id="assistantCardTemplate">
    <div class="agent-card" data-assistant-id="">
        <div class="agent-top">
            <img class="agent-avatar" data-role="avatar" src="https://placehold.co/112x112" alt="Assistant Avatar">
            <div>
                <div class="agent-name" data-role="name">Name</div>
                <div class="badge" data-role="direction">OUTBOUND</div>
            </div>
            <div class="agent-menu" title="More">‚ãØ</div>
        </div>

        <div class="agent-title" data-role="title">Title / Use-case goes here</div>

        <div class="agent-company">
            <span class="briefcase">üíº</span>
            <span data-role="company">Company</span>
        </div>

        <div class="divider"></div>

        <div class="agent-actions">
            <button class="btn role" data-action="assistant-role" disabled>üåê Role Play</button>
            <button class="btn primary" data-action="assistant-call">üìû Test</button>
        </div>

        <!-- Hidden inputs so your existing playgroundCall can read nm_<id> and ph_<id> -->
        <input type="hidden" data-role="hidden-name">
        <input type="hidden" data-role="hidden-phone">
    </div>
</template>

<!-- External JS only -->
<script src="js/ai-call.js"></script>
</body>
</html>
