<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VISTAAR - AI Solutions for Business Expansion</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root{
            --primary:#2563eb; --primary-dark:#1d4ed8; --secondary:#7c3aed; --accent:#f59e0b;
            --text-dark:#1f2937; --text-light:#6b7280; --bg-light:#f9fafb; --white:#fff;
            --gradient:linear-gradient(135deg,#2563eb 0%,#7c3aed 100%);
            --shadow-lg:0 20px 25px -5px rgba(0,0,0,.1),0 10px 10px -5px rgba(0,0,0,.04);
            --shadow-xl:0 25px 50px -12px rgba(0,0,0,.25);
            --success:#16a34a; --error:#b91c1c; --warn:#b45309; --radius:14px;
        }
        body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;line-height:1.6;color:var(--text-dark);overflow-x:hidden}
        .container{max-width:1200px;margin:0 auto;padding:0 20px}

        /* Nav */
        nav{position:fixed;inset:0 0 auto 0;background:rgba(255,255,255,.95);backdrop-filter:blur(10px);z-index:1000;transition:.3s}
        nav.scrolled{background:#fff;box-shadow:0 1px 3px rgba(0,0,0,.1)}
        .nav-content{display:flex;align-items:center;justify-content:space-between;padding:1rem 0}
        .logo{font-size:2rem;font-weight:800;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .nav-links{display:flex;list-style:none;gap:2rem}
        .nav-links a{color:var(--text-dark);text-decoration:none;font-weight:500;position:relative;transition:.3s}
        .nav-links a:hover{color:var(--primary)}
        .nav-links a::after{content:"";position:absolute;left:0;bottom:-4px;height:2px;width:0;background:var(--primary);transition:width .3s}
        .nav-links a:hover::after{width:100%}
        .cta-button{background:var(--gradient);color:#fff;padding:.75rem 1.5rem;border:none;border-radius:50px;font-weight:600;text-decoration:none;cursor:pointer;transition:.3s;box-shadow:var(--shadow-lg)}
        .cta-button:hover{transform:translateY(-2px);box-shadow:var(--shadow-xl)}
        /* Auth buttons */
        .auth-actions{display:flex;gap:.75rem;align-items:center}
        .btn-link{background:transparent;border:none;color:var(--text-dark);font-weight:600;cursor:pointer;padding:.5rem .75rem;border-radius:10px}
        .btn-link:hover{background:#f1f5f9;color:var(--primary)}
        .btn-primary{background:#111827;color:#fff;border:none;padding:.6rem 1rem;border-radius:12px;cursor:pointer;font-weight:700}
        .btn-primary:hover{opacity:.95}

        /* Hero etc (unchanged) */
        .hero{min-height:100vh;display:flex;align-items:center;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);position:relative;overflow:hidden}
        .hero::before{content:"";position:absolute;inset:0;background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.05)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');opacity:.3}
        .hero-content{position:relative;z-index:2;text-align:center;color:#fff}
        .hero h1{font-size:clamp(2.5rem,5vw,4rem);font-weight:900;margin-bottom:1.5rem;opacity:0;animation:fadeInUp 1s ease .3s both}
        .hero p{font-size:1.25rem;margin-bottom:2rem;opacity:0;animation:fadeInUp 1s ease .6s both;max-width:600px;margin-inline:auto}
        .hero-buttons{display:flex;gap:1rem;justify-content:center;flex-wrap:wrap;opacity:0;animation:fadeInUp 1s ease .9s both}
        .btn-secondary{background:transparent;color:#fff;padding:1rem 2rem;border:2px solid #fff;border-radius:50px;font-weight:600;text-decoration:none;cursor:pointer;transition:.3s}
        .btn-secondary:hover{background:#fff;color:var(--primary);transform:translateY(-3px)}
        .features{padding:6rem 0;background:var(--bg-light)}
        .section-title{ text-align:center;font-size:2.5rem;font-weight:800;margin-bottom:1rem;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .section-subtitle{text-align:center;font-size:1.2rem;color:var(--text-light);margin-bottom:4rem;max-width:600px;margin-inline:auto}
        .features-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(350px,1fr));gap:3rem;margin-top:4rem}
        .feature-card{background:#fff;padding:3rem 2rem;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.1);text-align:center;transition:.3s;position:relative;overflow:hidden}
        .feature-card:hover{transform:translateY(-10px);box-shadow:var(--shadow-xl)}
        .feature-icon{width:80px;height:80px;background:var(--gradient);border-radius:20px;display:grid;place-items:center;margin:0 auto 1.5rem;font-size:2rem;color:#fff}
        .benefits{padding:6rem 0;background:#fff}
        .benefits-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:2rem;margin-top:3rem}
        .benefit-item{text-align:center;padding:2rem;transition:.3s}
        .benefit-item:hover{transform:scale(1.05)}
        .benefit-number{font-size:3rem;font-weight:900;background:var(--gradient);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
        .contact{padding:6rem 0;background:var(--bg-light)}
        .contact-wrap{display:grid;grid-template-columns:1.1fr 1.1fr;gap:2rem;align-items:start}
        .contact-card{background:#fff;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.08);padding:2rem}
        .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
        .form-grid .full{grid-column:1 / -1}
        .field{display:flex;flex-direction:column;gap:.4rem}
        .label{font-weight:600;font-size:.95rem;color:var(--text-dark)}
        .input,.textarea{border:1px solid #e5e7eb;border-radius:12px;padding:.9rem 1rem;font-size:1rem;outline:none;transition:border .2s,box-shadow .2s}
        .input:focus,.textarea:focus{border-color:var(--primary);box-shadow:0 0 0 4px rgba(37,99,235,.1)}
        .textarea{min-height:120px;resize:vertical}
        .submit-row{display:flex;align-items:center;gap:.8rem;margin-top:.4rem}
        .submit-btn{background:var(--gradient);color:#fff;padding:.9rem 1.4rem;border:none;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:var(--shadow-lg);transition:.1s}
        .submit-btn[disabled]{opacity:.65;cursor:not-allowed}
        .cta-section{padding:6rem 0;background:var(--gradient);text-align:center;position:relative;overflow:hidden}
        .cta-content{position:relative;z-index:2;color:#fff}
        footer{background:#1f2937;color:#fff;text-align:center;padding:2rem 0}

        /* Toasts */
        .toast{position:fixed;right:20px;bottom:20px;display:grid;gap:.5rem;z-index:1200}
        .toast-msg{background:#fff;border-left:6px solid var(--success);padding:.9rem 1rem;border-radius:12px;box-shadow:var(--shadow-lg);min-width:260px}
        .toast-msg.error{border-left-color:var(--error)}
        .toast-msg.warn{border-left-color:var(--warn)}

        /* Auth Modal */
        .modal{position:fixed;inset:0;background:rgba(2,6,23,.55);display:none;align-items:center;justify-content:center;z-index:1201}
        .modal.open{display:flex}
        .modal-card{width:min(560px,92vw);background:#fff;border-radius:16px;box-shadow:var(--shadow-xl);overflow:hidden}
        .modal-header{display:flex}
        .tab{flex:1;text-align:center;padding:14px 10px;font-weight:800;cursor:pointer;border-bottom:3px solid transparent}
        .tab.active{border-bottom-color:var(--primary);color:var(--primary)}
        .modal-body{padding:20px}
        .close-x{position:absolute;right:18px;top:12px;background:transparent;border:none;font-size:22px;cursor:pointer}
        .auth-grid{display:grid;gap:12px}
        .auth-grid .row{display:flex;flex-direction:column;gap:6px}
        .auth-actions-bottom{display:flex;align-items:center;gap:10px;margin-top:8px}
        .small{color:var(--text-light);font-size:.9rem}

        @keyframes fadeInUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:none}}
        .fade-in{opacity:0;transform:translateY(20px);transition:.6s}
        .fade-in.visible{opacity:1;transform:none}

        @media (max-width:900px){.contact-wrap{grid-template-columns:1fr}.form-grid{grid-template-columns:1fr}}
        @media (max-width:768px){.nav-links{display:none}}
        .typing-effect{border-right:2px solid #fff;white-space:nowrap;overflow:hidden;animation:typing 4s steps(30) infinite, blink .75s step-end infinite}
        @keyframes typing{0%{width:0}50%{width:100%}100%{width:0}}@keyframes blink{from,to{border-color:transparent}50%{border-color:#fff}}
        .floating-elements{position:absolute;inset:0;pointer-events:none;overflow:hidden}
        .floating-element{position:absolute;width:4px;height:4px;background:rgba(255,255,255,.3);border-radius:50%;animation:floatUp 8s linear infinite}
        @keyframes floatUp{0%{transform:translateY(100vh);opacity:1}100%{transform:translateY(-100px) rotate(360deg);opacity:0}}
    </style>
</head>
<body>
<!-- Navigation -->
<nav id="navbar">
    <div class="container">
        <div class="nav-content">
            <div class="logo">VISTAAR AI</div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#features">Features</a></li>
                <li><a href="#benefits">Benefits</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <!-- TOP-RIGHT AUTH BUTTONS -->
            <div class="auth-actions">
                <button class="btn-link" id="openSignIn">Sign In</button>
                <button class="btn-primary" id="openSignUp">Sign Up</button>
            </div>
        </div>
    </div>
</nav>

<!-- Hero -->
<section id="home" class="hero">
    <div class="floating-elements"></div>
    <div class="container">
        <div class="hero-content">
            <h1>Transform Your Business with <br><span class="typing-effect">AI-Powered Solutions</span></h1>
            <p>VISTAAR empowers businesses to expand beyond limits with cutting-edge AI technology. Streamline operations, enhance customer interactions, and unlock new growth opportunities.</p>
            <div class="hero-buttons">
                <a href="#features" class="btn-primary">Discover Solutions</a>
                <a href="#benefits" class="btn-secondary">Learn More</a>
            </div>
        </div>
    </div>
</section>

<!-- Features -->
<section id="features" class="features">
    <div class="container">
        <h2 class="section-title fade-in">Revolutionary AI Features</h2>
        <p class="section-subtitle fade-in">Experience the future of business automation with our intelligent solutions</p>
        <div class="features-grid">
            <div class="feature-card fade-in">
                <div class="feature-icon">ðŸŽ¤</div>
                <h3>AI Voice Agent</h3>
                <p>Intelligent conversational AI that handles customer inquiries 24/7â€¦</p>
            </div>
            <div class="feature-card fade-in">
                <div class="feature-icon">ðŸ“„</div>
                <h3>AI Document Scanner</h3>
                <p>Advanced OCR technology that digitizes, analyzes, and extracts insightsâ€¦</p>
            </div>
        </div>
    </div>
</section>

<!-- Benefits -->
<section id="benefits" class="benefits">
    <div class="container">
        <h2 class="section-title fade-in">Why Choose VISTAAR?</h2>
        <p class="section-subtitle fade-in">Measurable results that drive business expansion</p>
        <div class="benefits-grid">
            <div class="benefit-item fade-in"><div class="benefit-number stats-counter" data-target="85">0</div><h4>Efficiency Boost</h4><p>Average increase in operational efficiency</p></div>
            <div class="benefit-item fade-in"><div class="benefit-number stats-counter" data-target="70">0</div><h4>Cost Reduction</h4><p>Decrease in manual processing costs</p></div>
            <div class="benefit-item fade-in"><div class="benefit-number stats-counter" data-target="95">0</div><h4>Accuracy Rate</h4><p>Document processing accuracy</p></div>
            <div class="benefit-item fade-in"><div class="benefit-number stats-counter" data-target="24">0</div><h4>Always Available</h4><p>Hours of AI-powered support</p></div>
        </div>
    </div>
</section>

<!-- Contact -->
<section id="contact" class="contact">
    <div class="container">
        <h2 class="section-title fade-in">Get in Touch</h2>
        <p class="section-subtitle fade-in">Tell us a bit about you. Weâ€™ll reach out with a custom demo and pricing.</p>
        <div class="contact-wrap">
            <div class="contact-card fade-in">
                <h3>Contact Details</h3>
                <p>Fill the form and weâ€™ll call you back.</p>
                <form id="contactForm" novalidate>
                    <input type="text" id="hp_field" style="position:absolute;left:-9999px;opacity:0;height:0;width:0" tabindex="-1" aria-hidden="true">
                    <div class="form-grid">
                        <div class="field"><label class="label" for="name">Full Name *</label><input class="input" id="name" required></div>
                        <div class="field"><label class="label" for="email">Email *</label><input class="input" id="email" type="email" required></div>
                        <div class="field"><label class="label" for="phone">Phone *</label><input class="input" id="phone" type="tel" required pattern="^[0-9+\-\s()]{7,}$"></div>
                        <div class="field"><label class="label" for="company">Company</label><input class="input" id="company"></div>
                        <div class="field full"><label class="label" for="message">What are you looking to achieve?</label><textarea class="textarea" id="message"></textarea></div>
                    </div>
                    <div class="submit-row">
                        <button class="submit-btn" id="submitBtn" type="submit">Submit</button>
                        <span class="small" id="formHelper">Weâ€™ll get back within 24 hours.</span>
                    </div>
                </form>
            </div>
            <div class="contact-card fade-in">
                <h3>Reach Us</h3>
                <ul style="list-style:none;display:grid;gap:.6rem;color:var(--text-dark);padding-left:0">
                    <li><strong>Call:</strong> +91 98765 43210</li>
                    <li><strong>Email:</strong> hello@vistaar.ai</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<!-- CTA -->
<section class="cta-section">
    <div class="container">
        <div class="cta-content">
            <h2>Ready to Expand Your Business?</h2>
            <p>Join thousands of businesses already transforming with VISTAAR AI solutions</p>
            <a href="#contact" class="btn-primary" id="startJourney">Start Your AI Journey</a>
        </div>
    </div>
</section>

<footer><div class="container"><p>&copy; 2025 VISTAAR. All rights reserved.</p></div></footer>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- AUTH MODAL -->
<div class="modal" id="authModal" aria-hidden="true">
    <div class="modal-card">
        <button class="close-x" id="closeAuth" aria-label="Close">âœ•</button>
        <div class="modal-header">
            <div class="tab active" id="tabSignIn">Sign In</div>
            <div class="tab" id="tabSignUp">Sign Up</div>
        </div>
        <div class="modal-body">
            <!-- Sign In form (posts to Spring Security) -->
            <form id="signInForm" method="post" action="/auth/login" class="auth-grid">
                <div class="row">
                    <label class="label">Username (email)</label>
                    <input class="input" name="username" required autocomplete="username">
                </div>
                <div class="row">
                    <label class="label">Password</label>
                    <input class="input" name="password" type="password" required autocomplete="current-password">
                </div>
                <input type="hidden" name="_csrf" id="csrfLoginHidden">
                <div class="auth-actions-bottom">
                    <button class="submit-btn" type="submit">Sign In</button>
                    <span class="small">New here? <a href="#" id="switchToSignUp">Create account</a></span>
                </div>
            </form>

            <!-- Sign Up form (AJAX to /auth/signup) -->
            <form id="signUpForm" class="auth-grid" style="display:none">
                <div class="row">
                    <label class="label">Full name</label>
                    <input class="input" name="fullName" autocomplete="name">
                </div>
                <div class="row">
                    <label class="label">Email (username)</label>
                    <input class="input" name="username" type="email" required autocomplete="email">
                </div>
                <div class="row">
                    <label class="label">Password</label>
                    <input class="input" name="password" type="password" required autocomplete="new-password" minlength="6">
                </div>
                <div class="auth-actions-bottom">
                    <button class="submit-btn" id="signUpBtn" type="submit">Create Account</button>
                    <span class="small">Already have an account? <a href="#" id="switchToSignIn">Sign in</a></span>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // ===== CONFIG =====
    const API_BASE = window.API_BASE || window.location.origin;
    const LEAD_ENDPOINT = API_BASE + '/api/actions/leads';
    // AUTH CONFIG (align these with your Spring Boot routes)
    const SIGNUP_ENDPOINT = '/auth/signup';    // POST
    // Login posts to /auth/login via form

    // Smooth scroll
    document.querySelectorAll('a[href^="#"]').forEach(a=>{
        a.addEventListener('click',e=>{
            e.preventDefault();
            const t=document.querySelector(a.getAttribute('href'));
            if(t) t.scrollIntoView({behavior:'smooth',block:'start'});
        });
    });

    // Navbar scroll
    window.addEventListener('scroll',()=>{
        const n=document.getElementById('navbar');
        if(window.scrollY>50) n.classList.add('scrolled'); else n.classList.remove('scrolled');
    });

    // Fade-in observer
    const io=new IntersectionObserver(es=>es.forEach(e=>e.isIntersecting&&e.target.classList.add('visible')),{threshold:.1,rootMargin:'0px 0px -50px 0px'});
    document.querySelectorAll('.fade-in').forEach(el=>io.observe(el));

    // Counters
    function animateCounter(el,target){let c=0,inc=target/100;const t=setInterval(()=>{c+=inc;if(c>=target){c=target;clearInterval(t)}el.textContent=Math.floor(c)+'%'},20)}
    const so=new IntersectionObserver(es=>es.forEach(en=>{if(en.isIntersecting){const el=en.target;animateCounter(el,parseInt(el.dataset.target));so.unobserve(el)}}));
    document.querySelectorAll('.stats-counter').forEach(c=>so.observe(c));

    // Floating dots
    function createFloatingElement(){const el=document.createElement('div');el.className='floating-element';el.style.left=Math.random()*100+'%';el.style.animationDelay=Math.random()*8+'s';el.style.animationDuration=(Math.random()*4+6)+'s';return el}
    const fc=document.querySelector('.floating-elements'); for(let i=0;i<50;i++) fc.appendChild(createFloatingElement());

    // CTA ripple & scroll
    document.getElementById('startJourney').addEventListener('click',e=>{
        e.preventDefault(); document.querySelector('#contact').scrollIntoView({behavior:'smooth'});
    });

    // Toast helper
    const toast=document.getElementById('toast');
    const showToast=(msg,type='success')=>{
        const el=document.createElement('div'); el.className='toast-msg '+(type==='error'?'error':type==='warn'?'warn':''); el.textContent=msg;
        toast.appendChild(el); setTimeout(()=>el.remove(),3500);
    };

    // Contact form
    const form=document.getElementById('contactForm'), submitBtn=document.getElementById('submitBtn'), helper=document.getElementById('formHelper');
    const validEmail=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e), validPhone=p=>/^[0-9+\-\s()]{7,}$/.test(p);
    form.addEventListener('submit',async e=>{
        e.preventDefault(); if(document.getElementById('hp_field').value) return;
        const name=nameEl.value.trim(), email=emailEl.value.trim(), phone=phoneEl.value.trim(), company=companyEl.value.trim(), message=messageEl.value.trim();
    });
    const nameEl=document.getElementById('name'), emailEl=document.getElementById('email'), phoneEl=document.getElementById('phone'), companyEl=document.getElementById('company'), messageEl=document.getElementById('message');
    form.addEventListener('submit', async (e)=>{
        e.preventDefault();
        if(!nameEl.value||!emailEl.value||!phoneEl.value){showToast('Please fill required fields: Name, Email, Phone.','warn');return}
        if(!validEmail(emailEl.value)){showToast('Please enter a valid email.','warn');return}
        if(!validPhone(phoneEl.value)){showToast('Please enter a valid phone.','warn');return}
        submitBtn.disabled=true; const original=submitBtn.textContent; submitBtn.textContent='Submittingâ€¦'; helper.textContent='Sending your details securelyâ€¦';
        const payload={name:nameEl.value.trim(),email:emailEl.value.trim(),phone:phoneEl.value.trim(),company:companyEl.value.trim(),message:messageEl.value.trim(),source:'vistaar-landing',ts:new Date().toISOString()};
        try{
            const res=await fetch(LEAD_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload),credentials:'include'});
            if(!res.ok){let t='Failed to submit.';try{const j=await res.json();if(j?.message||j?.error)t=j.message||j.error}catch{} throw new Error(t+` (HTTP ${res.status})`)}
            showToast('Thank you! We will reach out shortly.'); form.reset(); helper.textContent='Submitted successfully. Weâ€™ll contact you soon.';
        }catch(err){console.error(err); showToast(err.message||'Something went wrong.','error'); helper.textContent='Submission failed. Please try again.'}
        finally{submitBtn.disabled=false; submitBtn.textContent=original;}
    });

    // ===== AUTH MODAL LOGIC =====
    const modal=document.getElementById('authModal');
    const openSignIn=document.getElementById('openSignIn');
    const openSignUp=document.getElementById('openSignUp');
    const closeAuth=document.getElementById('closeAuth');
    const tabSignIn=document.getElementById('tabSignIn');
    const tabSignUp=document.getElementById('tabSignUp');
    const formSignIn=document.getElementById('signInForm');
    const formSignUp=document.getElementById('signUpForm');
    const signUpBtn=document.getElementById('signUpBtn');
    const csrfLoginHidden=document.getElementById('csrfLoginHidden');

    const getCookie = (name) => document.cookie.split('; ').find(r=>r.startsWith(name+'='))?.split('=')[1];

    function openModal(tab='signin'){
        modal.classList.add('open');
        setTab(tab);
        // Inject CSRF into login form (Spring Security XSRF-TOKEN cookie)
        const xsrf=getCookie('XSRF-TOKEN');
        if(xsrf){ csrfLoginHidden.value = decodeURIComponent(xsrf); }
    }
    function closeModal(){ modal.classList.remove('open'); }
    function setTab(which){
        if(which==='signin'){
            tabSignIn.classList.add('active'); tabSignUp.classList.remove('active');
            formSignIn.style.display='grid'; formSignUp.style.display='none';
        }else{
            tabSignUp.classList.add('active'); tabSignIn.classList.remove('active');
            formSignUp.style.display='grid'; formSignIn.style.display='none';
        }
    }

    openSignIn.addEventListener('click',()=>openModal('signin'));
    openSignUp.addEventListener('click',()=>openModal('signup'));
    closeAuth.addEventListener('click',closeModal);
    modal.addEventListener('click',(e)=>{ if(e.target===modal) closeModal(); });
    tabSignIn.addEventListener('click',()=>setTab('signin'));
    tabSignUp.addEventListener('click',()=>setTab('signup'));
    document.getElementById('switchToSignUp').addEventListener('click',(e)=>{e.preventDefault();setTab('signup')});
    document.getElementById('switchToSignIn').addEventListener('click',(e)=>{e.preventDefault();setTab('signin')});

    // SIGN UP (AJAX â†’ /auth/signup)
    formSignUp.addEventListener('submit', async (e)=>{
        e.preventDefault();
        const fd = new FormData(formSignUp);
        const username = fd.get('username')?.toString().trim();
        const password = fd.get('password')?.toString();
        if(!username || !password){ showToast('Email and Password are required.','warn'); return; }
        signUpBtn.disabled=true; const old=signUpBtn.textContent; signUpBtn.textContent='Creatingâ€¦';
        try{
            const res = await fetch(SIGNUP_ENDPOINT, {
                method:'POST',
                headers:{
                    'Content-Type':'application/x-www-form-urlencoded',
                    'X-XSRF-TOKEN': decodeURIComponent(getCookie('XSRF-TOKEN')||'')
                },
                body: new URLSearchParams({
                    username,
                    password,
                    fullName: fd.get('fullName')?.toString() || ''
                }).toString(),
                credentials:'include'
            });
            if(!res.ok){
                let msg='Signup failed';
                try{ const j=await res.json(); if(j?.error) msg=j.error; }catch{}
                throw new Error(msg+` (HTTP ${res.status})`);
            }
            showToast('Registered! Please sign in.');
            setTab('signin');
        }catch(err){
            console.error(err); showToast(err.message || 'Could not create account.','error');
        }finally{
            signUpBtn.disabled=false; signUpBtn.textContent=old;
        }
    });

    // Keyboard ESC to close modal
    window.addEventListener('keydown',(e)=>{ if(e.key==='Escape' && modal.classList.contains('open')) closeModal(); });

    // Typing effect
    const typingTexts=['AI-Powered Solutions','Smart Voice Agents','Intelligent Document Processing','Business Expansion Tools'];
    let ti=0, ci=0, del=false; const te=document.querySelector('.typing-effect');
    (function type(){ const t=typingTexts[ti]; te.textContent=del?t.substring(0,--ci):t.substring(0,++ci);
        if(!del && ci===t.length) setTimeout(()=>del=true,2000);
        else if(del && ci===0){ del=false; ti=(ti+1)%typingTexts.length; }
        setTimeout(type, del?50:100);
    })();
</script>
</body>
</html>
